# Project TADB FCUP 2024/2025

This project focuses on developing a solution that includes managing a PostgreSQL database, executing Python scripts for database setup, and generating reports/renderings based on the data, all orchestrated using Docker and Docker Compose to ensure an isolated and reproducible development environment.

## Project Overview

The project is structured to allow for:

1.  Defining a containerized development environment using **Docker** and **Docker Compose**.
2.  Utilizing a **PostgreSQL** database as the persistence layer.
3.  Executing **Python** scripts to interact with the database (setup, population) and to generate graphical output (rendering) using libraries like **Matplotlib**.
4.  Persistent storage for database data and generated outputs across container executions using **Docker Volumes**.

## Directory Structure

The project directory structure is organized as follows (based on the provided screenshot):

* `.devcontainer/`: Contains configuration files for a containerized development environment (often used with VS Code Dev Containers).
    * `devcontainer.json`: Specific configuration for the development environment inside the container.
    * `docker-compose.yml`: Defines the Docker services (database, application) and their interconnections, including volume mapping.
    * `Dockerfile`: Specifies how to build the Docker image for the Python application service.
* `python/`: Contains the main application Python scripts.
    * `show_tetrominoes.py`: (Presumably) The script responsible for retrieving data from the DB and generating renderings/plots with Matplotlib.
* `report/setup/`: Contains scripts and files for the initial database setup and population.
    * `create_tables.sql`: SQL script for creating tables in the database.
    * `populate_tables.py`: Python script or other file for inserting initial data into tables.
    * `setup_db.py`: Python script that orchestrates the database setup process (likely executing `create_tables.sql` and `populate_tables.py`).
* `requirements.txt`: Lists the necessary Python dependencies for running the scripts in the `app` environment (e.g., `psycopg2`, `matplotlib`).
* `./output/` (This directory will be created by Docker on your host, by default in the same directory as `docker-compose.yml` if you used `./output` in the volume mapping): Contains files generated by the rendering scripts (e.g., plot images).
* `entrypoint.sh` (If present and used): A script (often in the root or copied inside the container) that serves as the container's entry point, managing the order of script execution and waiting for dependencies (e.g., database readiness).
* `test_container_initialization.sh`: Script for testing container initialization.
* `.gitignore`: Specifies files and directories to be ignored by Git version control.
* `LICENSE`: Project license file.
* `README.md`: This file, providing a project overview.

## Setup and Running

To start the environment and execute the scripts:

1.  Ensure you have Docker and Docker Compose installed on your machine.
2.  Open a terminal in the `.devcontainer/` directory (where `docker-compose.yml` is located).
3.  Build the images and start the services defined in `docker-compose.yml`. The `--build` flag is needed the first time or after modifying the `Dockerfile` or files that are copied into the image.
    ```bash
    docker compose up --build
    ```
4.  The execution will follow the order and commands defined in `docker-compose.yml` and the optional `entrypoint.sh` (or `start.sh`) script, typically starting PostgreSQL, waiting for it to be ready, executing `setup_db.py`, and finally `show_tetrominoes.py`.
5.  To stop the services:
    ```bash
    docker compose down
    ```
    This will stop and remove the containers, but by default it will **not** remove the PostgreSQL data volume (`postgres_data`) or the output directory (`./devcontainer/output` or `./output`).

## Output

Files generated by the rendering script (`show_tetrominoes.py`), such as Matplotlib plots, will be saved to the **`./output/`** directory (or `./devcontainer/output/` depending on your configuration in `docker-compose.yml`) on your host machine. This directory is mapped to the `/app/output` directory inside the container via the volume configuration.

## Development with Dev Containers (Optional)

If you use a development environment like VS Code with the "Dev Containers" extension, you can leverage the `.devcontainer/devcontainer.json` file to open the entire project (the main directory) inside the defined Docker container, providing a pre-configured development environment with all necessary dependencies already installed.

---

**Note:** Ensure that the paths within your Python scripts (`setup_db.py`, `show_tetrominoes.py`) and in the `entrypoint.sh` script (if you use it) correctly refer to the locations of the files **inside the container** (e.g., `/app/report/setup/setup_db.py`, `/app/python/show_tetrominoes.py`, `/app/output/`).